<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sense360 Firmware Configuration Tool</title>
    <link rel="icon" type="image/png" sizes="32x32" href="./sense360-favicon-32.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/wizard-style.css?v=1753432000">
    <link rel="stylesheet" href="./css/capability-bar.css">
    <link rel="stylesheet" href="./css/theme.css">
    <link rel="stylesheet" href="./css/layout.css">
    <link rel="stylesheet" href="./css/device-qr.css">
    <link rel="stylesheet" href="./css/features.css">
    <script type="module" src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"></script>
</head>
<body>
    <div class="container">
        <header class="page-header">
            <div class="logo-container">
                <img src="./sense360-logo-new.png" alt="Sense360 Logo" class="logo">
                <div class="header-text">
                    <h1>Sense360 Firmware Configuration Tool</h1>
                    <p class="subtitle">Flash your Sense360 hub directly from your browser in under 60 seconds</p>
                </div>
            </div>
            <button type="button" class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">
                <svg class="theme-toggle__icon--sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <circle cx="12" cy="12" r="5"/>
                    <line x1="12" y1="1" x2="12" y2="3"/>
                    <line x1="12" y1="21" x2="12" y2="23"/>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                    <line x1="1" y1="12" x2="3" y2="12"/>
                    <line x1="21" y1="12" x2="23" y2="12"/>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                </svg>
                <svg class="theme-toggle__icon--moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                </svg>
            </button>
        </header>

        <nav class="path-selector" aria-label="Choose your firmware path">
            <div class="path-selector__options">
                <a href="#step-1" class="path-card path-card--active" data-path="prebuilt">
                    <div class="path-card__content">
                        <h3 class="path-card__title">Flash Pre-built Firmware</h3>
                        <p class="path-card__description">Install tested configurations for your hardware. Select your device type and install directly from your browser.</p>
                    </div>
                    <span class="path-card__badge">Recommended</span>
                </a>
                <a href="https://github.com/sense360store/esphome-public" target="_blank" rel="noopener noreferrer" class="path-card" data-path="custom">
                    <div class="path-card__content">
                        <h3 class="path-card__title">Build Custom Firmware</h3>
                        <p class="path-card__description">Configure custom firmware using ESPHome YAML. Adjust sensors, update intervals, and integration settings.</p>
                    </div>
                    <span class="path-card__external">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6M15 3h6v6M10 14L21 3"/>
                        </svg>
                    </span>
                </a>
            </div>
        </nav>

        <div class="wizard-container">
            <!-- Sidebar is injected by scripts/layout/init-splitview.js via the outer .wizard-shell -->
            <div class="wizard-layout" data-layout="single-column">
                <div class="wizard-main">
                    <!-- Progress Indicator -->
                    <div class="progress-bar">
                <div class="progress-step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">Core</div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">Mounting</div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">Power</div>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="step-number">4</div>
                    <div class="step-label">Modules</div>
                </div>
                <div class="progress-step" data-step="5">
                    <div class="step-number">5</div>
                    <div class="step-label">Review</div>
                </div>
                    </div>

                    <!-- Step 1: Core Configuration -->
                    <div class="wizard-step step" id="step-1">
                <h2>Step 1: Configure Core Features</h2>

                <aside class="safety-notice" aria-label="Important safety information">
                    <div class="safety-notice__icon" aria-hidden="true">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="safety-notice__content">
                        <strong>Before you begin:</strong> Use desktop Chrome or Edge. During flashing, <strong>do not disconnect power</strong> and keep this browser tab open.
                    </div>
                </aside>

                <section class="core-config-section" aria-label="Voice assistant configuration">
                    <h3 class="core-config-section__title">Voice Assistant</h3>
                    <p class="core-config-section__description">Enable voice control for hands-free operation and audio feedback.</p>
                    <div class="option-grid">
                        <label class="option-card">
                            <input type="radio" name="voice" value="none" checked>
                            <div class="option-content">
                                <div class="option-header">
                                    <div class="option-title">None</div>
                                </div>
                                <div class="option-description">No voice control hardware</div>
                            </div>
                        </label>
                        <label class="option-card">
                            <input type="radio" name="voice" value="base">
                            <div class="option-content">
                                <div class="option-header">
                                    <div class="option-title">Voice Assistant</div>
                                </div>
                                <div class="option-description">I2S microphone array and audio output. Requires Rev B core or newer, J5 audio interface header.</div>
                            </div>
                        </label>
                    </div>
                </section>

                <div class="wizard-actions">
                    <button class="btn btn-primary btn-next" type="button" data-next>Next</button>
                </div>
                    </div>

                    <!-- Step 2: Mounting Type -->
                    <div class="wizard-step step" id="step-2" hidden aria-hidden="true">
                <h2>Step 2: Where is this unit being installed?</h2>

                <div class="quick-start-presets" data-quick-start-presets>
                    <p class="quick-start-presets__label">Quick start:</p>
                    <div class="quick-start-presets__buttons">
                        <button class="btn btn-secondary btn-preset" type="button" data-preset="recommended" data-preset-config='{"mount":"wall","power":"usb","airiq":"base","presence":"base","comfort":"none","fan":"none"}'>
                            Popular: Wall + AirIQ &amp; Presence
                        </button>
                        <button class="btn btn-secondary btn-preset" type="button" data-preset="ceiling" data-preset-config='{"mount":"ceiling","power":"poe","airiq":"base","presence":"none","comfort":"none","fan":"none"}'>
                            Ceiling + POE
                        </button>
                        <button class="btn btn-secondary btn-preset" type="button" data-preset="minimal" data-preset-config='{"mount":"wall","power":"usb","airiq":"none","presence":"none","comfort":"none","fan":"none"}'>
                            Minimal: Wall + USB only
                        </button>
                    </div>
                    <p class="quick-start-presets__hint">Or configure step-by-step below</p>
                </div>
                <div class="option-grid">
                    <label class="option-card">
                        <input type="radio" name="mounting" value="wall">
                        <div class="option-content">
                            <div class="option-header">
                                <div class="option-title">Wall Mount</div>
                                <button
                                    type="button"
                                    class="option-info-button"
                                    data-option-info
                                    data-option-group="mounting"
                                    data-option-value="wall"
                                    aria-label="Details about Wall Mount"
                                    aria-controls="option-info-popover"
                                    aria-describedby="option-info-popover-summary"
                                >
                                    <span aria-hidden="true">i</span>
                                </button>
                            </div>
                            <div class="option-description">Standard wall installation with full module support</div>
                        </div>
                    </label>
                    <label class="option-card">
                        <input type="radio" name="mounting" value="ceiling">
                        <div class="option-content">
                            <div class="option-header">
                                <div class="option-title">Ceiling Mount</div>
                                <button
                                    type="button"
                                    class="option-info-button"
                                    data-option-info
                                    data-option-group="mounting"
                                    data-option-value="ceiling"
                                    aria-label="Details about Ceiling Mount"
                                    aria-controls="option-info-popover"
                                    aria-describedby="option-info-popover-summary"
                                >
                                    <span aria-hidden="true">i</span>
                                </button>
                            </div>
                            <div class="option-description">Ceiling installation</div>
                        </div>
                    </label>
                </div>
                <div class="wizard-actions">
                    <button class="btn btn-secondary" type="button" data-back>Back</button>
                    <button class="btn btn-primary btn-next" type="button" data-next disabled>Next</button>
                </div>
                    </div>

                    <!-- Step 3: Power Option -->
                    <div class="wizard-step step" id="step-3" hidden aria-hidden="true">
                <h2>Step 3: Select Power Option</h2>
                <div class="option-grid">
                    <label class="option-card">
                        <input type="radio" name="power" value="usb">
                        <div class="option-content">
                            <div class="option-header">
                                <div class="option-title">USB Power</div>
                                <button
                                    type="button"
                                    class="option-info-button"
                                    data-option-info
                                    data-option-group="power"
                                    data-option-value="usb"
                                    aria-label="Details about USB Power"
                                    aria-controls="option-info-popover"
                                    aria-describedby="option-info-popover-summary"
                                >
                                    <span aria-hidden="true">i</span>
                                </button>
                            </div>
                            <div class="option-description">Standard USB-C power connection</div>
                        </div>
                    </label>
                    <label class="option-card">
                        <input type="radio" name="power" value="poe">
                        <div class="option-content">
                            <div class="option-header">
                                <div class="option-title">POE Module</div>
                                <button
                                    type="button"
                                    class="option-info-button"
                                    data-option-info
                                    data-option-group="power"
                                    data-option-value="poe"
                                    aria-label="Details about POE Module"
                                    aria-controls="option-info-popover"
                                    aria-describedby="option-info-popover-summary"
                                >
                                    <span aria-hidden="true">i</span>
                                </button>
                            </div>
                            <div class="option-description">Power over Ethernet module</div>
                        </div>
                    </label>
                    <label class="option-card">
                        <input type="radio" name="power" value="pwr">
                        <div class="option-content">
                            <div class="option-header">
                                <div class="option-title">PWR Module</div>
                                <button
                                    type="button"
                                    class="option-info-button"
                                    data-option-info
                                    data-option-group="power"
                                    data-option-value="pwr"
                                    aria-label="Details about PWR Module"
                                    aria-controls="option-info-popover"
                                    aria-describedby="option-info-popover-summary"
                                >
                                    <span aria-hidden="true">i</span>
                                </button>
                            </div>
                            <div class="option-description">External power module</div>
                        </div>
                    </label>
                </div>
                <div class="wizard-actions">
                    <button class="btn btn-secondary" type="button" data-back>Back</button>
                    <button class="btn btn-primary btn-next" type="button" data-next disabled>Next</button>
                </div>
                    </div>

                <!-- Step 4: Expansion Modules -->
                <div class="wizard-step step" id="step-4" hidden aria-hidden="true">
                <h2>Step 4: Add Expansion Modules</h2>
                <div class="module-status-bar" id="module-availability-hint" role="status" aria-live="polite">
                    Select a mounting and power option to see supported expansion modules.
                </div>

                <div class="module-step-grid" role="region" aria-label="Expansion module selection">
                    <div class="module-step-grid__main">
                        <!-- Bathroom toggle - only visible for ceiling installations -->
                        <section class="bathroom-toggle-section" id="bathroom-toggle-section" style="display: none;">
                            <div class="bathroom-toggle">
                                <label class="bathroom-toggle__label">
                                    <input type="checkbox" name="bathroom" class="bathroom-toggle__checkbox">
                                    <span class="bathroom-toggle__text">
                                        <strong>Bathroom Installation</strong>
                                        <span class="bathroom-toggle__description">Enable bathroom-specific features and optional Bathroom AirIQ module (ceiling only)</span>
                                    </span>
                                </label>
                            </div>
                        </section>

                        <section class="module-collection" aria-label="Expansion module groups">
                            <section class="module-group" data-module-group="airiq" data-expanded="false">
                                <div class="module-group__summary">
                                    <div class="module-group__summary-text">
                                        <h3 class="module-group__title">AirIQ Module</h3>
                                        <span class="module-group__summary-label" data-module-group-summary>Selected: AirIQ None</span>
                                    </div>
                                    <button
                                        type="button"
                                        class="btn btn-tertiary module-group__summary-button"
                                        data-module-group-toggle
                                        data-module-group-key="airiq"
                                        aria-expanded="false"
                                        aria-controls="module-group-airiq"
                                    >
                                        Change
                                    </button>
                                </div>
                                <div class="module-group__body" id="module-group-airiq" data-module-group-body hidden>
                                    <p class="module-group__description">Air quality stack for particulate, VOC, and CO₂ sensors.</p>
                                    <div class="module-card-grid">
                                    <label class="module-card option-card" data-module-card="airiq" data-variant="none">
                                        <input type="radio" name="airiq" value="none" checked>
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">None</div>
                                                    <p class="option-description module-card__description">Core only, no AirIQ sensors.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>No additional requirement</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>No additional headers</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="airiq" data-variant="base">
                                        <input type="radio" name="airiq" value="base">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Base</div>
                                                    <p class="option-description module-card__description">Balanced air quality sensing with VOC, CO₂, and particulate coverage.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>Rev B core or newer</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>J4 sensor bus · J7 auxiliary power</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" data-module-card-conflicts>
                                                <span class="module-card__badge" data-conflict-badge data-conflict-module="fan" data-conflict-variants="analog" title="Select PWM fan control or remove the AirIQ Base module to free the DAC bus." aria-label="Conflicts with Fan Analog: Select PWM fan control or remove the AirIQ Base module to free the DAC bus.">Fan Analog</span>
                                                <span class="module-card__badge" data-conflict-badge data-conflict-module="bathroomairiq" data-conflict-variants="base" title="Choose either standard AirIQ or Bathroom AirIQ, not both." aria-label="Conflicts with Bathroom AirIQ: Choose either standard AirIQ or Bathroom AirIQ, not both.">Bathroom AirIQ</span>
                                            </div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="airiq" data-variant="pro">
                                        <input type="radio" name="airiq" value="pro">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Pro</div>
                                                    <p class="option-description module-card__description">Full particulate insights plus advanced gas and flow monitoring.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>Rev C core or newer</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>J4 sensor bus · J6 particulate harness · J7 auxiliary power</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" data-module-card-conflicts>
                                                <span class="module-card__badge" data-conflict-badge data-conflict-module="fan" data-conflict-variants="analog" title="Choose PWM fan control or downgrade AirIQ to Base to regain analog fan support." aria-label="Conflicts with Fan Analog: Choose PWM fan control or downgrade AirIQ to Base to regain analog fan support.">Fan Analog</span>
                                                <span class="module-card__badge" data-conflict-badge data-conflict-module="presence" data-conflict-variants="pro" title="Use Presence Base or remove one of the modules to avoid UART contention." aria-label="Conflicts with Presence Pro: Use Presence Base or remove one of the modules to avoid UART contention.">Presence Pro</span>
                                                <span class="module-card__badge" data-conflict-badge data-conflict-module="bathroomairiq" data-conflict-variants="base" title="Choose either standard AirIQ or Bathroom AirIQ, not both." aria-label="Conflicts with Bathroom AirIQ: Choose either standard AirIQ or Bathroom AirIQ, not both.">Bathroom AirIQ</span>
                                            </div>
                                        </div>
                                    </label>
                                    </div>
                                </div>
                                </section>

                            <section class="module-group" data-module-group="bathroomairiq" id="bathroomairiq-module-section" data-expanded="false" style="display: none;">
                                <div class="module-group__summary">
                                    <div class="module-group__summary-text">
                                        <h3 class="module-group__title">Bathroom AirIQ Module</h3>
                                        <span class="module-group__summary-label" data-module-group-summary>Selected: Bathroom AirIQ None</span>
                                    </div>
                                    <button
                                        type="button"
                                        class="btn btn-tertiary module-group__summary-button"
                                        data-module-group-toggle
                                        data-module-group-key="bathroomairiq"
                                        aria-expanded="false"
                                        aria-controls="module-group-bathroomairiq"
                                    >
                                        Change
                                    </button>
                                </div>
                                <div class="module-group__body" id="module-group-bathroomairiq" data-module-group-body hidden>
                                    <p class="module-group__description">Ceiling-mounted air quality sensors optimized for bathroom environments.</p>
                                    <div class="module-card-grid">
                                    <label class="module-card option-card" data-module-card="bathroomairiq" data-variant="none">
                                        <input type="radio" name="bathroomairiq" value="none" checked>
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">None</div>
                                                    <p class="option-description module-card__description">Core only, no Bathroom AirIQ sensors.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>No additional requirement</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>No additional headers</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="bathroomairiq" data-variant="base">
                                        <input type="radio" name="bathroomairiq" value="base">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Base</div>
                                                    <p class="option-description module-card__description">Humidity, temperature, and air quality monitoring optimized for bathroom environments.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>Rev B core or newer</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>J4 sensor bus · J7 auxiliary power</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" data-module-card-conflicts>
                                                <span class="module-card__badge" data-conflict-badge data-conflict-module="airiq" data-conflict-variants="base pro" title="Choose either Bathroom AirIQ or standard AirIQ, not both." aria-label="Conflicts with AirIQ Base/Pro: Choose either Bathroom AirIQ or standard AirIQ, not both.">AirIQ Base/Pro</span>
                                            </div>
                                        </div>
                                    </label>
                                    </div>
                                </div>
                            </section>

                            <section class="module-group" data-module-group="presence" data-expanded="false">
                                <div class="module-group__summary">
                                    <div class="module-group__summary-text">
                                        <h3 class="module-group__title">Presence Module</h3>
                                        <span class="module-group__summary-label" data-module-group-summary>Selected: Presence None</span>
                                    </div>
                                    <button
                                        type="button"
                                        class="btn btn-tertiary module-group__summary-button"
                                        data-module-group-toggle
                                        data-module-group-key="presence"
                                        aria-expanded="false"
                                        aria-controls="module-group-presence"
                                    >
                                        Change
                                    </button>
                                </div>
                                <div class="module-group__body" id="module-group-presence" data-module-group-body hidden>
                                    <p class="module-group__description">mmWave radar options for occupancy detection.</p>
                                    <div class="module-card-grid">
                                    <label class="module-card option-card" data-module-card="presence" data-variant="none">
                                        <input type="radio" name="presence" value="none" checked>
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">None</div>
                                                    <p class="option-description module-card__description">Skip presence sensing.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>No additional requirement</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>No additional headers</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="presence" data-variant="base">
                                        <input type="radio" name="presence" value="base">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Base</div>
                                                    <p class="option-description module-card__description">Single-zone mmWave radar coverage.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>Rev B core or newer</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>J2 radar slot</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="presence" data-variant="pro">
                                        <input type="radio" name="presence" value="pro">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Pro</div>
                                                    <p class="option-description module-card__description">Dual-zone radar with LD2450 secondary coverage.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>Rev D core</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>J2 radar slot · J8 secondary UART</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" data-module-card-conflicts>
                                                <span class="module-card__badge" data-conflict-badge data-conflict-module="airiq" data-conflict-variants="pro" title="Select AirIQ Base or remove one of the modules." aria-label="Conflicts with AirIQ Pro: Select AirIQ Base or remove one of the modules.">AirIQ Pro</span>
                                            </div>
                                        </div>
                                    </label>
                                    </div>
                                </div>
                            </section>

                            <section class="module-group" data-module-group="comfort" data-expanded="false">
                                <div class="module-group__summary">
                                    <div class="module-group__summary-text">
                                        <h3 class="module-group__title">Comfort Module</h3>
                                        <span class="module-group__summary-label" data-module-group-summary>Selected: Comfort None</span>
                                    </div>
                                    <button
                                        type="button"
                                        class="btn btn-tertiary module-group__summary-button"
                                        data-module-group-toggle
                                        data-module-group-key="comfort"
                                        aria-expanded="false"
                                        aria-controls="module-group-comfort"
                                    >
                                        Change
                                    </button>
                                </div>
                                <div class="module-group__body" id="module-group-comfort" data-module-group-body hidden>
                                    <p class="module-group__description">Environmental sensing for comfort tuning.</p>
                                    <div class="module-card-grid">
                                    <label class="module-card option-card" data-module-card="comfort" data-variant="none">
                                        <input type="radio" name="comfort" value="none" checked>
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">None</div>
                                                    <p class="option-description module-card__description">Skip comfort sensors.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>No additional requirement</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>No additional headers</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="comfort" data-variant="base">
                                        <input type="radio" name="comfort" value="base">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Base</div>
                                                    <p class="option-description module-card__description">Humidity and ambient light monitoring.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>Rev A core or newer</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>J3 environmental header</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    </div>
                                </div>
                            </section>

                            <section class="module-group" data-module-group="fan" id="fan-module-section" data-expanded="false">
                                <div class="module-group__summary">
                                    <div class="module-group__summary-text">
                                        <h3 class="module-group__title">Fan Module</h3>
                                        <span class="module-group__summary-label" data-module-group-summary>Selected: Fan None</span>
                                    </div>
                                    <button
                                        type="button"
                                        class="btn btn-tertiary module-group__summary-button"
                                        data-module-group-toggle
                                        data-module-group-key="fan"
                                        aria-expanded="false"
                                        aria-controls="module-group-fan"
                                    >
                                        Change
                                    </button>
                                </div>
                                <div class="module-group__body" id="module-group-fan" data-module-group-body hidden>
                                    <p class="module-group__description">Output driver choices for external fan control.</p>
                                    <div class="module-card-grid">
                                    <label class="module-card option-card" data-module-card="fan" data-variant="none">
                                        <input type="radio" name="fan" value="none" checked>
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">None</div>
                                                    <p class="option-description module-card__description">No fan control hardware.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>No additional requirement</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>No additional headers</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="fan" data-variant="pwm">
                                        <input type="radio" name="fan" value="pwm">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">PWM</div>
                                                    <p class="option-description module-card__description">Variable speed fan control via PWM driver.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>Rev A core or newer</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>J9 PWM driver</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="fan" data-variant="analog">
                                        <input type="radio" name="fan" value="analog">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Analog</div>
                                                    <p class="option-description module-card__description">0–10V analog fan control with isolation harness.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>Rev C core or newer</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>J4 analog DAC · J10 isolation harness</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" data-module-card-conflicts>
                                                <span class="module-card__badge" data-conflict-badge data-conflict-module="airiq" data-conflict-variants="base pro" title="Disable AirIQ or switch the fan output to PWM mode." aria-label="Conflicts with AirIQ Base/Pro: Disable AirIQ or switch the fan output to PWM mode.">AirIQ Base/Pro</span>
                                            </div>
                                        </div>
                                    </label>
                                    </div>
                                </div>
                            </section>

                            <section class="module-group" data-module-group="bathroomairiq" id="bathroomairiq-module-section" data-expanded="false" style="display: none;">
                                <div class="module-group__summary">
                                    <div class="module-group__summary-text">
                                        <h3 class="module-group__title">Bathroom AirIQ Module</h3>
                                        <span class="module-group__summary-label" data-module-group-summary>Selected: Bathroom AirIQ None</span>
                                    </div>
                                    <button
                                        type="button"
                                        class="btn btn-tertiary module-group__summary-button"
                                        data-module-group-toggle
                                        data-module-group-key="bathroomairiq"
                                        aria-expanded="false"
                                        aria-controls="module-group-bathroomairiq"
                                    >
                                        Change
                                    </button>
                                </div>
                                <div class="module-group__body" id="module-group-bathroomairiq" data-module-group-body hidden>
                                    <p class="module-group__description">Bathroom-optimized air quality sensing with humidity, pressure, VOC/NOx, and optional condensation detection.</p>
                                    <div class="module-card-grid">
                                    <label class="module-card option-card" data-module-card="bathroomairiq" data-variant="none">
                                        <input type="radio" name="bathroomairiq" value="none" checked>
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">None</div>
                                                    <p class="option-description module-card__description">Bathroom configuration without AirIQ sensors.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>No additional requirement</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>No additional headers</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="bathroomairiq" data-variant="base">
                                        <input type="radio" name="bathroomairiq" value="base">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Base</div>
                                                    <p class="option-description module-card__description">Humidity, pressure, and VOC/NOx sensing for bathroom environments.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>To be added</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>To be added</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Sensors</dt>
                                                    <dd>SHT4x (temp/humidity) · BMP390 (pressure) · SGP41 (VOC/NOx)</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    <label class="module-card option-card" data-module-card="bathroomairiq" data-variant="pro">
                                        <input type="radio" name="bathroomairiq" value="pro">
                                        <div class="module-card__inner">
                                            <div class="module-card__header">
                                                <div class="module-card__titles">
                                                    <div class="option-title module-card__title">Pro</div>
                                                    <p class="option-description module-card__description">Full sensor suite with IR surface temperature, condensation risk detection, and particulate monitoring.</p>
                                                </div>
                                                <span class="module-card__state" aria-hidden="true">
                                                    <span class="module-card__state-label module-card__state-label--default">Select</span>
                                                    <span class="module-card__state-label module-card__state-label--active">Selected</span>
                                                </span>
                                            </div>
                                            <dl class="module-card__specs">
                                                <div class="module-card__spec">
                                                    <dt>Core</dt>
                                                    <dd>To be added</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Headers</dt>
                                                    <dd>To be added</dd>
                                                </div>
                                                <div class="module-card__spec">
                                                    <dt>Sensors</dt>
                                                    <dd>SHT4x · BMP390 · SGP41 · MLX90614 (IR/condensation) · SPS30 (PM1.0/2.5/10)</dd>
                                                </div>
                                            </dl>
                                            <div class="module-card__badges" aria-hidden="true"></div>
                                        </div>
                                    </label>
                                    </div>
                                </div>
                            </section>
                        </section>

                        <section class="module-detail" id="module-requirements-panel" aria-live="polite" aria-label="Module requirements">
                            <div class="module-requirements-panel__placeholder">
                                Highlight a module option to see required core revisions, headers, and conflicts.
                            </div>
                        </section>
                    </div>

                    <aside class="module-step-grid__summary module-step-grid__summary--inline" data-module-summary data-module-summary-variant="module" aria-label="Configuration summary">
                        <div class="module-summary-card">
                            <header class="module-summary-card__header">
                                <h3 class="module-summary-card__title">Your configuration</h3>
                                <p class="module-summary-card__subtitle">Selections across mounting, power, and modules.</p>
                            </header>
                            <div class="module-summary-card__body" data-module-summary-list role="list"></div>
                            <p class="module-summary-card__warning" data-module-summary-warning hidden></p>
                            <section class="module-summary-card__hardware" aria-label="Hardware requirements" data-hardware-summary>
                                <div class="module-summary-card__hardware-header">
                                    <h4>Hardware requirements</h4>
                                </div>
                                <p class="module-summary-card__hardware-empty" data-hardware-summary-empty>None yet</p>
                                <p class="module-summary-card__hardware-core" data-hardware-summary-core hidden></p>
                                <ul class="module-summary-card__hardware-list" data-hardware-summary-headers hidden></ul>
                            </section>
                            <div class="module-summary-card__actions">
                                <button type="button" class="btn btn-secondary" data-module-summary-copy data-default-label="Copy link">Copy link</button>
                                <button type="button" class="btn btn-tertiary" data-module-summary-reset>Start over</button>
                            </div>
                        </div>
                    </aside>
                </div>

                
                <div class="wizard-actions">
                    <button class="btn btn-secondary" type="button" data-back>Back</button>
                    <button class="btn btn-primary btn-next" type="button" data-next>Next</button>
                </div>
                    </div>

                    <!-- Step 5: Review & Install -->
                    <div class="wizard-step step" id="step-5" hidden aria-hidden="true">
                <h2>Step 5: Review & Install</h2>

                <p class="step-intro">
                    Use desktop Chrome or Edge to connect your Sense360 hub. Then click &lsquo;Install firmware&rsquo;. If you&rsquo;re not on a supported browser, download the .bin instead.
                </p>

                <section class="configuration-summary" aria-labelledby="configuration-summary-heading">
                    <h3 id="configuration-summary-heading">Your selections</h3>
                    <div id="config-summary" aria-live="polite"></div>
                </section>

                <section class="pre-flash-checklist" aria-labelledby="pre-flash-checklist-heading">
                    <div class="pre-flash-checklist__header">
                        <h3 id="pre-flash-checklist-heading">Before you flash</h3>
                        <p>Review these essentials to keep your hub safe during the update.</p>
                    </div>
                    <ul class="pre-flash-checklist__items">
                        <li>Verify the Sense360 hub is powered and connected to your computer.</li>
                        <li>Keep this browser tab open until the flashing process finishes.</li>
                        <li><strong>Do not disconnect power/USB during flashing.</strong></li>
                    </ul>
                    <label class="pre-flash-checklist__acknowledgement">
                        <input type="checkbox" data-preflash-acknowledge>
                        <span class="preflash-warning-text">I understand and will keep the hub powered and connected throughout flashing.</span>
                    </label>
                </section>

                <div id="device-info-container" class="device-info-container" data-device-info-mount></div>

                <div class="firmware-section">
                    <h3 class="compatible-firmware-heading">
                        <span data-compatible-firmware-label>Compatible Firmware</span>
                        <span data-compatible-firmware-selection></span>
                    </h3>
                    <div class="firmware-selector" id="firmware-selector" hidden>
                        <label class="firmware-selector-label" for="firmware-version-select">Select firmware release</label>
                        <select id="firmware-version-select" class="firmware-selector-control" aria-label="Available firmware releases"></select>
                    </div>
                    <div id="compatible-firmware">
                        <!-- Compatible firmware will be shown here -->
                    </div>
                </div>

                <div class="wizard-actions">
                    <button class="btn btn-secondary" type="button" data-back>Back</button>
                    <p class="install-assumptions" data-install-assumptions hidden aria-hidden="true"></p>
                    <div class="primary-action-group">
                        <div class="primary-action-controls">
                            <button class="btn btn-primary" id="download-btn" type="button" onclick="downloadFirmware()" disabled>Download Firmware</button>
                            <button class="btn btn-copy" id="copy-firmware-url-btn" type="button" onclick="copyFirmwareUrl()" aria-label="Copy firmware link" disabled>
                                Copy
                            </button>
                            <button class="btn btn-secondary" id="open-ha-integrations-btn" type="button" onclick="openHomeAssistantIntegrations(event)" disabled>
                                Open Home Assistant Integrations
                            </button>
                        </div>
                        <p class="ready-helper" data-ready-helper role="status" aria-live="polite"></p>
                    </div>
                </div>
                <p class="help-text post-flash-guidance">
                    After the install finishes, keep the hub powered on and connected to the same network as Home Assistant. Discovery usually happens within a minute. If the device doesn&rsquo;t appear, open the integrations dashboard and follow the
                    <a href="https://esphome.io/guides/getting_started_hassio/#connecting-your-device-to-home-assistant" target="_blank" rel="noopener noreferrer">ESPHome adoption steps</a>
                    to add it manually.
                </p>
                <aside class="customize-callout">
                    <p class="customize-callout__text">
                        <strong>Need more control?</strong> Build custom firmware with our
                        <a href="https://github.com/sense360store/esphome-public" target="_blank" rel="noopener noreferrer">ESPHome YAML configs</a>
                        to add custom sensors, modify update intervals, or integrate with your own automations.
                    </p>
                </aside>
                    </div>
                </div>

            </div>
        </div>

        <div class="wizard-summary" data-mobile-summary data-option-details-bottom hidden aria-hidden="true">
            <button
                type="button"
                class="wizard-summary__toggle"
                data-mobile-summary-toggle
                aria-expanded="false"
                aria-controls="wizard-summary-drawer"
            >
                <span
                    class="wizard-summary__toggle-label"
                    data-mobile-summary-toggle-label
                    data-open-label="Hide summary"
                    data-closed-label="View summary"
                >
                    View summary
                </span>
            </button>
            <div
                class="wizard-summary__drawer"
                id="wizard-summary-drawer"
                data-mobile-summary-drawer
                role="dialog"
                aria-modal="true"
                aria-labelledby="wizard-summary-drawer-title"
                aria-hidden="true"
                tabindex="-1"
                data-open="false"
            >
                <div class="wizard-summary__drawer-surface">
                    <div class="wizard-summary__drawer-header">
                        <h2 class="wizard-summary__drawer-title" id="wizard-summary-drawer-title">Your configuration</h2>
                        <button
                            type="button"
                            class="wizard-summary__close"
                            data-mobile-summary-close
                        >
                            Close summary
                        </button>
                    </div>
                    <aside class="wizard-summary__card" data-module-summary data-module-summary-variant="module" aria-label="Configuration summary">
                        <div class="module-summary-card">
                            <header class="module-summary-card__header">
                                <h3 class="module-summary-card__title">Your configuration</h3>
                                <p class="module-summary-card__subtitle">Selections across mounting, power, and modules.</p>
                            </header>
                            <div class="module-summary-card__body" data-module-summary-list role="list"></div>
                            <p class="module-summary-card__warning" data-module-summary-warning hidden></p>
                            <section class="module-summary-card__firmware" aria-label="Firmware" data-module-summary-firmware>
                                <div class="module-summary-card__firmware-header">
                                    <h4>Firmware</h4>
                                    <p class="module-summary-card__firmware-empty" data-module-summary-firmware-empty>No build selected yet.</p>
                                </div>
                                <div class="module-summary-card__firmware-meta" data-module-summary-firmware-meta hidden>
                                    <p class="module-summary-card__firmware-name" data-module-summary-firmware-name></p>
                                    <p class="module-summary-card__firmware-version" data-module-summary-firmware-version></p>
                                    <p class="module-summary-card__firmware-size" data-module-summary-firmware-size></p>
                                </div>
                                <button type="button" class="btn btn-primary module-summary-card__install" data-module-summary-install disabled>Install</button>
                            </section>
                            <div class="module-summary-card__actions">
                                <button type="button" class="btn btn-secondary" data-module-summary-copy data-default-label="Copy link">Copy link</button>
                                <button type="button" class="btn btn-tertiary" data-module-summary-reset>Start over</button>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
        </div>

        <div id="option-info-popover" class="option-info-popover" role="dialog" aria-modal="false" aria-labelledby="option-info-popover-title" aria-describedby="option-info-popover-summary" tabindex="-1" hidden>
            <div class="option-info-popover__inner">
                <button type="button" class="option-info-popover__close" data-popover-close aria-label="Close details">
                    <span aria-hidden="true">&times;</span>
                </button>
                <div class="option-info-popover__header">
                    <h3 id="option-info-popover-title" class="option-info-popover__title" data-popover-title></h3>
                    <p id="option-info-popover-summary" class="option-info-popover__summary" data-popover-summary></p>
                </div>
                <div class="option-info-popover__sections">
                    <section class="option-info-popover__section" data-popover-pros-section hidden>
                        <h4 class="option-info-popover__section-title">Why choose it</h4>
                        <ul class="option-info-popover__list" data-popover-pros></ul>
                    </section>
                    <section class="option-info-popover__section" data-popover-cons-section hidden>
                        <h4 class="option-info-popover__section-title">Keep in mind</h4>
                        <ul class="option-info-popover__list" data-popover-cons></ul>
                    </section>
                    <section class="option-info-popover__section" data-popover-advanced-section hidden>
                        <h4 class="option-info-popover__section-title">Measurements &amp; advanced notes</h4>
                        <ul class="option-info-popover__list" data-popover-advanced></ul>
                    </section>
                </div>
            </div>
        </div>

        <div class="browser-check">
            <div class="browser-warning" id="browser-warning" style="display: none;">
                <h3>Browser Not Supported</h3>
                <p>
                    Web Serial works only in desktop Chrome or Edge. Safari, Firefox, and all iOS browsers are not
                    supported. <a href="https://developer.mozilla.org/docs/Web/API/Web_Serial_API" target="_blank" rel="noopener noreferrer">Learn more about the Web Serial API</a>.
                </p>
            </div>
        </div>
</div>

    <!-- Dynamically load app.js so it works from both / and /WebFlash/ -->
    <script type="module">
        const { pathname } = window.location;
        const inRepoSubpath = pathname === '/WebFlash' || pathname.startsWith('/WebFlash/');
        const scriptPath = inRepoSubpath ? '/WebFlash/app.js' : '/app.js';
        import(scriptPath);
    </script>
</body>
</html>
